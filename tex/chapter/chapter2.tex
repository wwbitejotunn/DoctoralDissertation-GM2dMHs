% LTeX: language=zh-CN
% TODO LIST
% 第二章 理论计算方法简介
\chapter{计算原理与方法}
\section{第一性原理计算方法}
第一性原理计算方法利用量子力学的基本原理，在无实验参数介入的情况下对量子系统进行模拟，如今以在
%//TODO

对于一个包含电子和原子核的物理系统，在不考虑相对论效应的情况下，我们可以根据量子力学理论，将整个系统的含时薛定谔方程$\hat{H}\Psi =E\Psi$写成如下形式\chinesecolon

\begin{equation}
    \begin{split}
        \biggl[-\sum_{i} \frac{\hbar}{2m_e}\nabla_i^2-\sum_{u} \frac{\hbar^2}{2M_u}\nabla_u^2-\sum_{i,u}\frac{e^2}{4\pi\epsilon_0}\frac{Z_u}{\left\lvert {\bm r}_i - {\bm R}_u \right\rvert } \biggr. \\[+1ex]
        \biggl.+\frac{1}{2} \sum_{u\neq v}\frac{e^2}{4\pi\epsilon_0}\frac{Z_uZ_v}{\left\lvert {\bm R}_u-{\bm R}_v\right\rvert} + \frac{1}{2}\sum_{i\neq j}\frac{e^2}{4\pi\epsilon_0} \frac{1}{\left\lvert {\bm r}_i - {\bm r}_j \right\rvert} \biggr]&\Psi_{\rm tot}=E_{\rm tot}\Psi_{\rm tot}
    \end{split}
\end{equation}
其中，$m_e$和$M_u$为系统内电子和原子核的质量；$e$和$Z_u$为电子和原子核的电荷量；${\bm r}_i$和${\bm R}_u$为电子和原子和在物理系统中欧给的空间坐标向量；$\hbar$和$\epsilon_0$为约化普朗克常数和真空电容率常数。

考虑到在通常的量子体系中，原子核的质量$M_u$通常比电子的质量$m_e$高三个数量级以上，因此在电子和原子核产生相互作用时，电子的运动速度通常远高于原子核的运动速度。此时我们可以运用波恩-奥本海默近似，将电子

\subsection{密度泛函理论}
\subsection{广义梯度近似交换关联泛函}
\subsection{投影缀加波函数方法赝势}
%//TODO

\section{气相反应动力学模拟}
%//TODO
chemkin
层流
\section{自由分子流模拟}
    在流体动力学中，克鲁森数（Knudsen number）通常用来区分连续流体和稀薄流体以及所适用的流体力学控制方程。克鲁森数$\rm Kn$的定义为\chinesecolon
    \begin{equation}
        {\rm Kn}=\frac{\lambda}{l}
    \end{equation}
    其中$\lambda$为气体分子运动的平均自由程\chinesecolon，$l$为所考虑体系的特征长度。气体分子运动的平均自由程$\lambda$可以表示为\chinesecolon
    \begin{equation}
        \lambda=\frac{\mu \sqrt{\frac{2k_{\rm B}T}{m}}}{P}
    \end{equation}
    $\kbconst$为玻尔兹曼常数，$m$是气体分子的质量，$T$是气体的温度，$P$为气体的气压。

    根据不同流体动力学系统中克鲁森数不同的取值，我们将气流分为三个区域。当流体体系中的克鲁森数非常小的时候（${\rm Kn}\ll 1$），我们可以将运动的气体分子看成连续介质。这时，气体满足连续性假设，可以利用流体力学中的纳维-斯托克斯方程（Navier-Stokes equations）\citing{RN1448-2013}进行分析。当体系中的克鲁森数非常大的时候（${\rm Kn}\gg 1$），由于相对较大的分子平均自由程，我们可以忽略气体分子之间的相互碰撞作用，使得每个气体分子的运动可以看出独立的过程。在这个区域的流体体系成为自由分子流。当克鲁森数约等于1的时候（${\rm Kn}\simeq 1$），我们既不能将此区域下的流体体系看成连续介质，使用N-S方程进行计算。由于和体系特征长度相近的平均自由程，我们同样无法忽略气体之间的相互碰撞，独立的考虑每个分子的运动情况。在这个区域的流体体系被称为过渡流，通常使用玻尔兹曼方程进行模拟计算\citing{RN1450-2003}。

    当克鲁森数（${\rm Kn}$）大于1时，根据我们先前的定义，流体处于自由分子流的区域，此时在体系内运功的气态分子之间的相互碰撞可以被忽略。我们可以将关注的重点放在气态分子在模拟系统中的运动轨迹以及分子于边界壁之间的作用关系。对于自由分子流的模拟，通常有两种方法。一种是使用蒙特卡罗法对对大量模拟体系中运动的气态分子进行随机化的轨迹模拟。另一种方法是使用角参数法计算。在本论文中，由于我们只关注气态分子在边界壁表面的统计分布情况，因此我们选用计算量更小的角参数法。

    在角参数法计算中，我们需要统计任一边界壁表面基元上从其他所有可能的表面基元直线入射的气体分子的流量。因此，我们需要计算在有边界壁的情况下，气态分子与边界壁相互作用下的速度分布函数。
    
    \subsection{自由分子流的速度分布函数}

    假设边界壁对气体分子不存在长时间的吸附作用，气体分子在碰撞到边界壁后直接出射、扩散至气体环境中。在这种情况下，我们可以计算边界壁表面出射的密度分布函数$\rho\left(\theta, v\right)$。其中$\theta$为气体分子的出射角度，$v$为气体分子的出射速度。此时，气体分子反射的角度分布满足余弦公式\chinesecolon
    \begin{equation}
        f\left(\theta\right)d\theta =\frac{1}{2}\cos\theta d\theta 
    \end{equation}    
    考虑二维的情况，反射角度$\theta$的取值范围为$\left(-\frac{\pi}{2},\frac{\pi}{2}\right)$

    假设密度分布函数$\rho\left(\theta, v\right)$中随机变量反射角度$\theta$和反射速度$v$相互独立，我们可以将$\rho\left(\theta, v\right)$写成一下形式\chinesecolon
    \[
        \rho\left(\sin\theta,v\right)=\rho_v\left(v\right)\rho_\theta\left(\sin\theta\right)
    \]
    为方便后续计算，这里我们将密度分布函数$\rho\left(\theta, v\right)$中反射角度$\theta$写成正弦的形式，既$\rho(\sin\theta,v)$。

    在二维的情况下，我们可以将反射分子的速度$v$分解为$v_x$和$v_y$，分别对应于反射分子平行于边界壁表面和垂直于边界壁表面的速度分量。$v_x$和$v_y$满足$v_x=v\sin\theta$和$v_y=v\cos\theta$。

    对于平行于边界壁表面的速度分量，由于对称性的关系，我们认为气态分子在边界壁反射的$v_x$分量服从玻尔兹曼分布\chinesecolon
    \begin{equation}
        \label{eq:FM_vxDensity}
        \rho_x\left(v_x\right)=\sqrt{\frac{m}{2\pi\kbconst T}}\exp\left({-\frac{mv_x^2}{2\kbconst T}}\right)
    \end{equation}

    然而，在边界壁的表面，垂直方向的反射运动并不满足对称性要求，因此垂直于边界壁表面的速度分量$v_y$并不满足玻尔兹曼分布。接下来我们对垂直于边界壁方向的分子速度分量分布进行推导。
    
    应用二维直角坐标系和极坐标系之间变换的雅可比行列式\chinesecolon
    \begin{equation}
        \left\lvert \frac{\partial \left(v_x,v_y\right)}{\partial \left(v,\sin\theta\right)}\right\rvert=\frac{v}{\cos\theta}
    \end{equation}
    我们可以写出分子速度的密度分布函数$\rho\left(\sin\theta,v\right)$的极坐标形式和直角坐标形式的关系如下\chinesecolon
    \[
        \rho\left(\sin\theta, v\right)=\frac{v}{\cos\theta}\rho\left(v_x,v_y\right)
    \]

    类似于$\rho\left(\sin\theta,v\right)$，极坐标下的速度分量$v_x$和$v_y$为独立的随机变量$\rho\left(v_x,v_y\right)=\rho_x\left(v_x\right)\rho_y\left(v_y\right)$

    将密度分布函数$\rho\left(\sin\theta,v\right)$求全角度积分，我们可以的得到速度模量的密度分布函数
    \begin{equation}
        \label{eq:FM_vDensity}
        \begin{split}
            \rho_v\left(v\right)&=\int_{-1}^{1} \rho\left(\sin\theta,v\right) \,d\sin\theta \\[+1ex]
            &= \int_{-1}^{1} \frac{v}{\cos\theta} \rho_x\left(v_x\right)\rho_y\left(v_y\right) \,d\sin\theta
        \end{split}
    \end{equation}

    对于密度分布函数$\rho\left(\sin\theta,v\right)$，其应该满足归一化条件\chinesecolon
    \begin{equation}
        \label{eq:FM_normalze_vDensity}
        \int_{0}^{\infty} \rho_v\left(v\right) \,dv = 1
    \end{equation}
    
    将式\ref{eq:FM_vDensity}和式\ref{eq:FM_vxDensity}带入归一化条件（式\ref{eq:FM_normalze_vDensity}），我们可以得到关于垂直边界壁方向速度密度分布函数的方程\chinesecolon
    \begin{equation}
        \label{eq:FM_vyDensity}
        \begin{split}
            & \int_{-1}^{1} \int_{0}^{\infty} \frac{v}{\cos\theta} \sqrt{\frac{m}{2\pi\kbconst T}}\exp\left({-\frac{mv^2\sin^2\theta}{2\kbconst T}}\right)\rho_y\left(v_y\right) \,dv  \,d\sin\theta =1\\[+1ex]
\Rightarrow & \rho_y\left(v_y\right)=\frac{mv\cos\theta}{\kbconst T}\exp\left({-\frac{mv^2\cos^2\theta}{2\kbconst T}}\right)=\frac{v_y}{\kbconst T}\exp\left(-\frac{mv_y^2}{2\kbconst T}\right)
        \end{split}
    \end{equation}

    结合式\ref{eq:FM_vxDensity}和式\ref{eq:FM_vyDensity}，我们可以得到气态分子在边界壁反射的具体速度密度分布函数$\rho_v\left(v\right)$\chinesecolon
    \begin{equation}
        \rho_v\left(v\right)=\sqrt{\frac{2}{\pi}} \left(\frac{m}{\kbconst T}\right)^{3/ 2}v^2\exp{\left(-\frac{mv^2}{2\kbconst T}\right)}
    \end{equation}

    由此，我们就可以通过计算每一个界壁表面基元上入射的气体分子的总流量，从而对体系内的自由分子流进行模拟。